import{l as Le,d as Ne,c as xe,b as _,t as S,i as Ie,e as Je}from"../chunks/nBeogWpe.js";import{av as Se,Y as Ge,aw as se,a2 as ie,Z as Re,$ as a,g as e,a0 as o,_ as r,a1 as de,a4 as Ue,c as $}from"../chunks/DlLfKX1o.js";import{s as C}from"../chunks/DBKkpHwF.js";import{a as Ve,t as ye}from"../chunks/Be3Rg8Bg.js";import{s as He,a as Pe,i as le}from"../chunks/_IW-XRo_.js";import{e as he,i as we}from"../chunks/DGtoNUrL.js";import{r as w,s as Ye,a as Ze}from"../chunks/C1i2H_Wl.js";import{b as k}from"../chunks/DccPWinQ.js";import{i as Ke,p as W}from"../chunks/B8OfZSBF.js";import{u as Qe}from"../chunks/BQGHVGXH.js";function De(t,s,i){if(t.multiple)return Xe(t,s);for(var c of t.options){var l=X(c);if(Ke(l,s)){c.selected=!0;return}}(!i||s!==void 0)&&(t.selectedIndex=-1)}function We(t,s){Se(()=>{var i=new MutationObserver(()=>{var c=t.__value;De(t,c)});return i.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{i.disconnect()}})}function ke(t,s,i=s){var c=!0;Le(t,"change",l=>{var m=l?"[selected]":":checked",b;if(t.multiple)b=[].map.call(t.querySelectorAll(m),X);else{var n=t.querySelector(m)??t.querySelector("option:not([disabled])");b=n&&X(n)}i(b)}),Se(()=>{var l=s();if(De(t,l,c),c&&l===void 0){var m=t.querySelector(":checked");m!==null&&(l=X(m),i(l))}t.__value=l,c=!1}),We(t)}function Xe(t,s){for(var i of t.options)i.selected=~s.indexOf(X(i))}function X(t){return"__value"in t?t.__value:t.value}async function et(t){try{if(!t)return null;const i=window.location.port!=="8000"?"http://localhost:8000":"",c=await fetch(`${i}/api/transactions/`,{method:"GET",headers:{Authorization:`Token ${t.token}`,"Content-Type":"application/json"}});if(!c.ok){const b=(await c.json()).error||"Failed to fetch transactions";return console.log(b),null}return await c.json()}catch(s){return console.error("Error during login:",s),null}}async function tt(t,s){try{if(!s)return null;const c=window.location.port!=="8000"?"http://localhost:8000":"",l=await fetch(`${c}/api/transactions/${t.id}/`,{method:"PUT",headers:{Authorization:`Token ${s.token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!l.ok){const n=(await l.json()).error||"Failed to edit transaction";return console.log(n),null}return await l.json()}catch(i){return console.error("Error during login:",i),null}}async function rt(t,s){try{if(!s)return null;const c=window.location.port!=="8000"?"http://localhost:8000":"",l=await fetch(`${c}/api/transactions/${t.id}/`,{method:"DELETE",headers:{Authorization:`Token ${s.token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!l.ok){const b=(await l.json()).error||"Failed to delete transaction";return console.log(b),null}return!0}catch(i){return console.error("Error during login:",i),null}}const ot=(t,s)=>{t.target===t.currentTarget&&s()};function at(t,s){$(s,null)}var nt=S('<p class="px-4 text-3xl font-semibold text-gray-500">No transactions found.</p>'),st=(t,s,i)=>s(e(i)),it=(t,s,i)=>s(e(i)),dt=S('<div class="bottom absolute right-4 rounded-md border border-[--border] bg-[--surface] p-2 shadow-lg"><p class="mb-2 text-sm">Delete this transaction?</p> <div class="flex justify-around gap-2"><button class="rounded px-2 py-1 text-xs hover:bg-[--muted-surface] transition-all duration-100 ease-in-out">Cancel</button> <button class="rounded bg-[--destructive] px-2 py-1 text-xs text-white hover:bg-[--destructive-hover] transition-all duration-100 ease-in-out">Confirm</button></div></div>'),lt=(t,s,i)=>s(e(i)),ct=S('<tr class="border-b border-[--border] transition-colors hover:bg-[--muted-surface]"><td class="p-4 text-center"> </td><td class="p-4 text-right"> </td><td class="p-4"> </td><td class="truncate p-4"> </td><td class="p-4"> </td><td class="p-4 text-right"><div class="flex flex-col justify-end"><button class="button">Edit</button> <div class="delete-actions"><!> <button class="button text-[--destructive] hover:text-[--destructive-hover]">Delete</button></div></div></td></tr>'),ut=S('<h3 class="border-b border-[--border] px-4 pb-2 text-3xl font-semibold text-[--primary-text]">Recent Transactions</h3> <table class="w-full table-fixed text-sm"><thead><tr class="border-b border-[--border] bg-[--surface]"><th class="h-12 w-28 px-4 text-center align-middle font-medium"><button class="inline-flex items-center gap-2 hover:text-blue-600">Date</button></th><th class="h-12 w-36 px-4 text-right align-middle font-medium"><button class="inline-flex items-center gap-2 hover:text-blue-600">Amount</button></th><th class="h-12 w-36 px-4 text-left align-middle font-medium">Category</th><th class="h-12 px-4 text-left align-middle font-medium">Description</th><th class="h-12 w-36 px-4 text-left align-middle font-medium">Vendor</th><th class="h-12 w-28 px-4 text-center align-middle font-medium">Actions</th></tr></thead><tbody></tbody></table>',1),vt=S("<option> </option>"),pt=S('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4"><div class="max-h-[90vh] w-full max-w-2xl overflow-auto rounded-lg bg-[--surface] shadow-xl"><div class="flex items-center justify-between border-b border-[--border] p-6"><h2 class="text-xl font-semibold">Edit Transaction</h2> <button type="button" class="ms-auto inline-flex h-8 w-8 items-center justify-center rounded-lg border-0 border-solid border-[--border] bg-transparent text-sm text-[--primary-text] transition-all duration-100 ease-in-out hover:border hover:bg-[--muted-surface]"><svg class="h-3 w-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path></svg> <span class="sr-only">Close modal</span></button></div> <form class="space-y-4 p-6"><div class="grid grid-cols-1 gap-4 md:grid-cols-2"><div class="space-y-2"><label for="date" class="block text-sm font-medium">Date</label> <input type="datetime-local" id="date" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></div> <div class="space-y-2"><label for="type" class="block text-sm font-medium">Type</label> <select id="type" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required><option>Income</option><option>Expense</option></select></div> <div class="space-y-2"><label for="amount" class="block text-sm font-medium">Amount</label> <input type="number" id="amount" step="0.01" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></div> <div class="space-y-2"><label for="original_amount" class="block text-sm font-medium">Original Amount</label> <input type="number" id="original_amount" step="0.01" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></div> <div class="space-y-2"><label for="currency" class="block text-sm font-medium">Currency</label> <input type="text" id="currency" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></div> <div class="space-y-2"><label for="original_currency" class="block text-sm font-medium">OG Currency</label> <input type="text" id="original_currency" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></div> <div class="space-y-2"><label for="card" class="block text-sm font-medium">Card</label> <input type="text" id="card" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></div> <div class="space-y-2"><label for="category" class="block text-sm font-medium">Category</label> <select id="category" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></select></div> <div class="space-y-2"><label for="vendor" class="block text-sm font-medium">Vendor</label> <input type="text" id="vendor" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></div> <div class="space-y-2"><label for="transaction_source" class="block text-sm font-medium">Source</label> <input type="text" id="transaction_source" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></div></div> <div class="space-y-2"><label for="description" class="block text-sm font-medium">Description</label> <textarea id="description" rows="3" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></textarea></div> <div class="flex justify-end gap-3 border-t pt-4" style="border-color: var(--border);"><button type="button" class="rounded-md border border-solid border-[--border] bg-[--muted-surface] px-4 py-2 text-sm font-medium transition-colors">Cancel</button> <button type="submit" class="rounded-md border border-solid border-[--border] bg-[--primary] px-4 py-2 text-sm font-semibold text-[--primary-dark-text] transition-colors hover:bg-[--primary-hover]">Save Changes</button></div></form></div></div>'),bt=S('<div class="rounded-lg bg-[--surface] pt-4 shadow"><!></div>  <!>  <div class="mt-8 rounded bg-[--surface] p-4"><h3 class="font-mono text-sm">Debug Data:</h3> <pre class="overflow-auto text-xs"> </pre></div>',1),mt=S('<div class="flex h-64 items-center justify-center"><p class="text-gray-500">Loading your transactions...</p></div>');function Tt(t,s){Ge(s,!0);const[i,c]=Pe(),l=()=>He(Qe,"$user",i),m=et(l());let b=se(W([])),n=se(W({})),L=se(null),ce=se(!1);const Te=["Food & Dining","Shopping","Transportation","Bills & Utilities","Entertainment","Travel","Healthcare","Education","Other"],je=u=>{$(n,W({...u})),$(ce,!0)},ee=()=>{$(ce,!1)},Ce=u=>{u.preventDefault();const f=u.target;e(n).date=f.date.value,$(b,W(e(b).map(N=>N.id===e(n).id?e(n):N))),tt(e(n),l()),ee()},$e=u=>new Date(u).toLocaleString(),Ee=(u,f)=>`${u} ${f}`;function pe(u){e(L)===u.id?(console.log("Deleting transaction:",u),rt(u,l()),$(L,null)):$(L,W(u.id))}var be=xe(),qe=ie(be);Ve(qe,()=>m,u=>{var f=mt();_(u,f)},(u,f)=>{var N=bt(),ue=ie(N),Oe=a(ue);{var Ae=p=>{var g=nt();_(p,g)},Me=p=>{var g=ut(),I=r(ie(g),2),E=r(a(I));he(E,21,()=>e(f),we,(ve,v,J)=>{var q=xe(),te=ie(q);{var G=D=>{var T=ct(),O=a(T),R=a(O,!0);o(O);var y=r(O),U=a(y,!0);o(y);var A=r(y),V=a(A,!0);o(A);var j=r(A),H=a(j,!0);o(j);var M=r(j),P=a(M,!0);o(M);var Y=r(M),B=a(Y),F=a(B);F.__click=[st,je,v];var z=r(F,2),Z=a(z);{var re=x=>{var h=dt(),K=r(a(h),2),ae=a(K);ae.__click=[at,L];var d=r(ae,2);d.__click=[it,pe,v],o(K),o(h),_(x,h)};le(Z,x=>{e(L)===e(v).id&&x(re)})}var oe=r(Z,2);oe.__click=[lt,pe,v],o(z),o(B),o(Y),o(T),de((x,h)=>{C(R,x),ye(y,"text-red-500",e(v).type=="expense"),ye(y,"text-green-500",e(v).type=="income"),C(U,h),C(V,e(v).category),Ze(j,"title",e(v).description||""),C(H,e(v).description||"-"),C(P,e(v).vendor)},[()=>$e(e(v).date),()=>Ee(e(v).amount,e(v).currency)]),_(D,T)};le(te,D=>{J<5&&D(G)})}_(ve,q)}),o(E),o(I),_(p,g)};le(Oe,p=>{e(f)===null||e(f).length===0?p(Ae):p(Me,!1)})}o(ue);var me=r(ue,2);{var Be=p=>{var g=pt();g.__click=[ot,ee];var I=a(g),E=a(I),ve=r(a(E),2);ve.__click=ee,o(E);var v=r(E,2),J=a(v),q=a(J),te=r(a(q),2);w(te),o(q);var G=r(q,2),D=r(a(G),2),T=a(D);T.value=(T.__value="income")==null?"":"income";var O=r(T);O.value=(O.__value="expense")==null?"":"expense",o(D),o(G);var R=r(G,2),y=r(a(R),2);w(y),o(R);var U=r(R,2),A=r(a(U),2);w(A),o(U);var V=r(U,2),j=r(a(V),2);w(j),o(V);var H=r(V,2),M=r(a(H),2);w(M),o(H);var P=r(H,2),Y=r(a(P),2);w(Y),o(P);var B=r(P,2),F=r(a(B),2);he(F,21,()=>Te,we,(d,ne)=>{var Q=vt(),ge={},ze=a(Q,!0);o(Q),de(()=>{ge!==(ge=e(ne))&&(Q.value=(Q.__value=e(ne))==null?"":e(ne)),C(ze,e(ne))}),_(d,Q)}),o(F),o(B);var z=r(B,2),Z=r(a(z),2);w(Z),o(z);var re=r(z,2),oe=r(a(re),2);w(oe),o(re),o(J);var x=r(J,2),h=r(a(x),2);Ie(h),o(x);var K=r(x,2),ae=a(K);ae.__click=ee,Ue(2),o(K),o(v),o(I),o(g),de(d=>Ye(te,d),[()=>new Date(e(n).date).toISOString().slice(0,16)]),Je("submit",v,Ce),ke(D,()=>e(n).type,d=>e(n).type=d),k(y,()=>e(n).amount,d=>e(n).amount=d),k(A,()=>e(n).original_amount,d=>e(n).original_amount=d),k(j,()=>e(n).currency,d=>e(n).currency=d),k(M,()=>e(n).original_currency,d=>e(n).original_currency=d),k(Y,()=>e(n).card,d=>e(n).card=d),ke(F,()=>e(n).category,d=>e(n).category=d),k(Z,()=>e(n).vendor,d=>e(n).vendor=d),k(oe,()=>e(n).transaction_source,d=>e(n).transaction_source=d),k(h,()=>e(n).description,d=>e(n).description=d),_(p,g)};le(me,p=>{e(ce)&&p(Be)})}var fe=r(me,2),_e=r(a(fe),2),Fe=a(_e,!0);o(_e),o(fe),de(p=>C(Fe,p),[()=>JSON.stringify(e(f),null,2)]),_(u,N)}),_(t,be),Re(),c()}Ne(["click"]);export{Tt as component};
