import{l as Le,d as Ne,c as he,b as _,t as T,i as Ge,e as Ie}from"../chunks/nBeogWpe.js";import{av as Te,Y as Je,aw as X,c as S,a2 as ie,Z as Re,$ as a,g as e,a0 as o,_ as r,a1 as le,a4 as Ve}from"../chunks/DlLfKX1o.js";import{s as E}from"../chunks/DBKkpHwF.js";import{a as Pe,t as ye}from"../chunks/Be3Rg8Bg.js";import{s as Ue,a as Ye,i as de}from"../chunks/_IW-XRo_.js";import{e as we,i as ke}from"../chunks/DGtoNUrL.js";import{r as w,s as Ze,a as He}from"../chunks/C1i2H_Wl.js";import{b as k}from"../chunks/DccPWinQ.js";import{i as Ke,p as q}from"../chunks/B8OfZSBF.js";import{u as Qe}from"../chunks/BQGHVGXH.js";function $e(t,n,i){if(t.multiple)return Xe(t,n);for(var c of t.options){var d=ee(c);if(Ke(d,n)){c.selected=!0;return}}(!i||n!==void 0)&&(t.selectedIndex=-1)}function We(t,n){Te(()=>{var i=new MutationObserver(()=>{var c=t.__value;$e(t,c)});return i.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{i.disconnect()}})}function Se(t,n,i=n){var c=!0;Le(t,"change",d=>{var m=d?"[selected]":":checked",p;if(t.multiple)p=[].map.call(t.querySelectorAll(m),ee);else{var s=t.querySelector(m)??t.querySelector("option:not([disabled])");p=s&&ee(s)}i(p)}),Te(()=>{var d=n();if($e(t,d,c),c&&d===void 0){var m=t.querySelector(":checked");m!==null&&(d=ee(m),i(d))}t.__value=d,c=!1}),We(t)}function Xe(t,n){for(var i of t.options)i.selected=~n.indexOf(ee(i))}function ee(t){return"__value"in t?t.__value:t.value}async function et(t){try{if(!t)return null;const i=window.location.port!=="8000"?"http://localhost:8000":"",c=await fetch(`${i}/api/transactions/categories/`,{method:"GET",headers:{Authorization:`Token ${t.token}`,"Content-Type":"application/json"}});if(!c.ok){const p=(await c.json()).error||"Failed to fetch categories";return console.log(p),null}return await c.json()}catch(n){return console.error("Error during login:",n),null}}async function tt(t){try{if(!t)return null;const i=window.location.port!=="8000"?"http://localhost:8000":"",c=await fetch(`${i}/api/transactions/`,{method:"GET",headers:{Authorization:`Token ${t.token}`,"Content-Type":"application/json"}});if(!c.ok){const p=(await c.json()).error||"Failed to fetch transactions";return console.log(p),null}return await c.json()}catch(n){return console.error("Error during login:",n),null}}async function rt(t,n){try{if(!n)return null;const c=window.location.port!=="8000"?"http://localhost:8000":"",d=await fetch(`${c}/api/transactions/${t.id}/`,{method:"PUT",headers:{Authorization:`Token ${n.token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!d.ok){const s=(await d.json()).error||"Failed to edit transaction";return console.log(s),null}return await d.json()}catch(i){return console.error("Error during login:",i),null}}async function ot(t,n){try{if(!n)return null;const c=window.location.port!=="8000"?"http://localhost:8000":"",d=await fetch(`${c}/api/transactions/${t.id}/`,{method:"DELETE",headers:{Authorization:`Token ${n.token}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(!d.ok){const p=(await d.json()).error||"Failed to delete transaction";return console.log(p),null}return!0}catch(i){return console.error("Error during login:",i),null}}const at=(t,n)=>{t.target===t.currentTarget&&n()};function nt(t,n){S(n,null)}var st=T('<p class="px-4 text-3xl font-semibold text-gray-500">No transactions found.</p>'),it=(t,n,i)=>n(e(i)),lt=(t,n,i)=>n(e(i)),dt=T('<div class="bottom absolute right-4 rounded-md border border-[--border] bg-[--surface] p-2 shadow-lg"><p class="mb-2 text-sm">Delete this transaction?</p> <div class="flex justify-around gap-2"><button class="rounded px-2 py-1 text-xs hover:bg-[--muted-surface] transition-all duration-100 ease-in-out">Cancel</button> <button class="rounded bg-[--destructive] px-2 py-1 text-xs text-white hover:bg-[--destructive-hover] transition-all duration-100 ease-in-out">Confirm</button></div></div>'),ct=(t,n,i)=>n(e(i)),ut=T('<tr class="transition-colors hover:bg-[--muted-surface]"><td class="p-4 text-center"> </td><td class="p-4 text-right font-semibold"> </td><td class="p-4"> </td><td class="truncate p-4"> </td><td class="p-4"> </td><td class="p-4 text-right"><div class="flex flex-col items-center"><button class="button">Edit</button> <div class="delete-actions"><!> <button class="button text-[--destructive] hover:text-[--destructive-hover]">Delete</button></div></div></td></tr>'),vt=T('<h3 class="border-b border-[--border] px-4 pb-2 text-3xl font-semibold text-[--primary-text]">Recent Transactions</h3> <table class="w-full table-fixed text-sm"><thead><tr class="border-b border-[--border] bg-[--surface]"><th class="h-12 w-28 px-4 text-center align-middle font-medium"><button class="inline-flex items-center gap-2 hover:text-blue-600">Date</button></th><th class="h-12 w-36 px-4 text-right align-middle font-medium"><button class="inline-flex items-center gap-2 hover:text-blue-600">Amount</button></th><th class="h-12 w-36 px-4 text-left align-middle font-medium">Category</th><th class="h-12 px-4 text-left align-middle font-medium">Description</th><th class="h-12 w-36 px-4 text-left align-middle font-medium">Vendor</th><th class="h-12 w-28 px-4 text-center align-middle font-medium">Actions</th></tr></thead><tbody class="divide-y divide-[--border] divide-solid"></tbody></table>',1),pt=T("<option> </option>"),bt=T('<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4"><div class="max-h-[90vh] w-full max-w-2xl overflow-auto rounded-lg bg-[--surface] shadow-xl"><div class="flex items-center justify-between border-b border-[--border] p-6"><h2 class="text-xl font-semibold">Edit Transaction</h2> <button type="button" class="ms-auto inline-flex h-8 w-8 items-center justify-center rounded-lg border-0 border-solid border-[--border] bg-transparent text-sm text-[--primary-text] transition-all duration-100 ease-in-out hover:border hover:bg-[--muted-surface]"><svg class="h-3 w-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path></svg> <span class="sr-only">Close modal</span></button></div> <form class="space-y-4 p-6"><div class="grid grid-cols-1 gap-4 md:grid-cols-2"><div class="space-y-2"><label for="date" class="block text-sm font-medium">Date</label> <input type="datetime-local" id="date" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></div> <div class="space-y-2"><label for="type" class="block text-sm font-medium">Type</label> <select id="type" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required><option>Income</option><option>Expense</option></select></div> <div class="space-y-2"><label for="amount" class="block text-sm font-medium">Amount</label> <input type="number" id="amount" step="0.01" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></div> <div class="space-y-2"><label for="original_amount" class="block text-sm font-medium">Original Amount</label> <input type="number" id="original_amount" step="0.01" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></div> <div class="space-y-2"><label for="currency" class="block text-sm font-medium">Currency</label> <input type="text" id="currency" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></div> <div class="space-y-2"><label for="original_currency" class="block text-sm font-medium">OG Currency</label> <input type="text" id="original_currency" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></div> <div class="space-y-2"><label for="card" class="block text-sm font-medium">Card</label> <input type="text" id="card" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></div> <div class="space-y-2"><label for="category" class="block text-sm font-medium">Category</label> <select id="category" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2" required></select></div> <div class="space-y-2"><label for="vendor" class="block text-sm font-medium">Vendor</label> <input type="text" id="vendor" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></div> <div class="space-y-2"><label for="transaction_source" class="block text-sm font-medium">Source</label> <input type="text" id="transaction_source" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></div></div> <div class="space-y-2"><label for="description" class="block text-sm font-medium">Description</label> <textarea id="description" rows="3" class="w-full rounded-md border border-solid border-[--border] bg-[--input-background] px-3 py-2"></textarea></div> <div class="flex justify-end gap-3 border-t pt-4" style="border-color: var(--border);"><button type="button" class="rounded-md border border-solid border-[--border] bg-[--muted-surface] px-4 py-2 text-sm font-medium transition-colors">Cancel</button> <button type="submit" class="rounded-md border border-solid border-[--border] bg-[--primary] px-4 py-2 text-sm font-semibold text-[--primary-dark-text] transition-colors hover:bg-[--primary-hover]">Save Changes</button></div></form></div></div>'),mt=T('<div class="rounded-lg bg-[--surface] pt-4 shadow"><!></div>  <!>  <div class="mt-8 rounded bg-[--surface] p-4"><h3 class="font-mono text-sm">Debug Data:</h3> <pre class="overflow-auto text-xs"> </pre></div>',1),ft=T('<div class="flex h-64 items-center justify-center"><p class="text-gray-500">Loading your transactions...</p></div>');function jt(t,n){Je(n,!0);const[i,c]=Ye(),d=()=>Ue(Qe,"$user",i),m=tt(d());let p=X(q([])),s=X(q({})),G=X(null),ce=X(!1),pe=X(q([]));et(d()).then(u=>{S(pe,q(u==null?void 0:u.categories))});const je=u=>{S(s,q({...u})),S(ce,!0)},te=()=>{S(ce,!1)},Ce=u=>{u.preventDefault();const f=u.target;e(s).date=f.date.value,S(p,q(e(p).map($=>$.id===e(s).id?e(s):$))),rt(e(s),d()),te()},De=u=>new Date(u).toLocaleString(),Ee=(u,f,$)=>$==="expense"?`-${u} ${f}`:`${u} ${f}`;function be(u){e(G)===u.id?(console.log("Deleting transaction:",u),ot(u,d()),S(G,null)):S(G,q(u.id))}var me=he(),qe=ie(me);Pe(qe,()=>m,u=>{var f=ft();_(u,f)},(u,f)=>{var $=mt(),ue=ie($),Ae=a(ue);{var Oe=b=>{var g=st();_(b,g)},Me=b=>{var g=vt(),I=r(ie(g),2),A=r(a(I));we(A,21,()=>e(f),ke,(ve,v,J)=>{var O=he(),re=ie(O);{var R=j=>{var C=ut(),M=a(C),V=a(M,!0);o(M);var h=r(M),P=a(h,!0);o(h);var z=r(h),U=a(z,!0);o(z);var D=r(z),Y=a(D,!0);o(D);var B=r(D),Z=a(B,!0);o(B);var H=r(B),F=a(H),L=a(F);L.__click=[it,je,v];var N=r(L,2),K=a(N);{var oe=x=>{var y=dt(),Q=r(a(y),2),ne=a(Q);ne.__click=[nt,G];var l=r(ne,2);l.__click=[lt,be,v],o(Q),o(y),_(x,y)};de(K,x=>{e(G)===e(v).id&&x(oe)})}var ae=r(K,2);ae.__click=[ct,be,v],o(N),o(F),o(H),o(C),le((x,y)=>{E(V,x),ye(h,"text-red-500",e(v).type=="expense"),ye(h,"text-green-500",e(v).type=="income"),E(P,y),E(U,e(v).category),He(D,"title",e(v).description||""),E(Y,e(v).description||"-"),E(Z,e(v).vendor)},[()=>De(e(v).date),()=>Ee(e(v).amount,e(v).currency,e(v).type)]),_(j,C)};de(re,j=>{J<5&&j(R)})}_(ve,O)}),o(A),o(I),_(b,g)};de(Ae,b=>{e(f)===null||e(f).length===0?b(Oe):b(Me,!1)})}o(ue);var fe=r(ue,2);{var ze=b=>{var g=bt();g.__click=[at,te];var I=a(g),A=a(I),ve=r(a(A),2);ve.__click=te,o(A);var v=r(A,2),J=a(v),O=a(J),re=r(a(O),2);w(re),o(O);var R=r(O,2),j=r(a(R),2),C=a(j);C.value=(C.__value="income")==null?"":"income";var M=r(C);M.value=(M.__value="expense")==null?"":"expense",o(j),o(R);var V=r(R,2),h=r(a(V),2);w(h),o(V);var P=r(V,2),z=r(a(P),2);w(z),o(P);var U=r(P,2),D=r(a(U),2);w(D),o(U);var Y=r(U,2),B=r(a(Y),2);w(B),o(Y);var Z=r(Y,2),H=r(a(Z),2);w(H),o(Z);var F=r(Z,2),L=r(a(F),2);we(L,21,()=>e(pe),ke,(l,se)=>{var W=pt(),xe={},Fe=a(W,!0);o(W),le(()=>{xe!==(xe=e(se))&&(W.value=(W.__value=e(se))==null?"":e(se)),E(Fe,e(se))}),_(l,W)}),o(L),o(F);var N=r(F,2),K=r(a(N),2);w(K),o(N);var oe=r(N,2),ae=r(a(oe),2);w(ae),o(oe),o(J);var x=r(J,2),y=r(a(x),2);Ge(y),o(x);var Q=r(x,2),ne=a(Q);ne.__click=te,Ve(2),o(Q),o(v),o(I),o(g),le(l=>Ze(re,l),[()=>new Date(e(s).date).toISOString().slice(0,16)]),Ie("submit",v,Ce),Se(j,()=>e(s).type,l=>e(s).type=l),k(h,()=>e(s).amount,l=>e(s).amount=l),k(z,()=>e(s).original_amount,l=>e(s).original_amount=l),k(D,()=>e(s).currency,l=>e(s).currency=l),k(B,()=>e(s).original_currency,l=>e(s).original_currency=l),k(H,()=>e(s).card,l=>e(s).card=l),Se(L,()=>e(s).category,l=>e(s).category=l),k(K,()=>e(s).vendor,l=>e(s).vendor=l),k(ae,()=>e(s).transaction_source,l=>e(s).transaction_source=l),k(y,()=>e(s).description,l=>e(s).description=l),_(b,g)};de(fe,b=>{e(ce)&&b(ze)})}var _e=r(fe,2),ge=r(a(_e),2),Be=a(ge,!0);o(ge),o(_e),le(b=>E(Be,b),[()=>JSON.stringify(e(f),null,2)]),_(u,$)}),_(t,me),Re(),c()}Ne(["click"]);export{jt as component};
