import{t as x,d as _,f as At}from"../chunks/Byjy3L_i.js";import{i as Ct}from"../chunks/C-xWZpZg.js";import{ag as qt,b as zt,h as M,a as Ft,ak as Ht,U as dt,m as Q,o as vt,n as ft,j as J,D as Gt,e as Bt,al as ut,am as _t,an as pt,a0 as Jt,i as W,p as X,ao as Ot,$ as Pt,a1 as Rt,af as i,ad as e,ae as t,ac as O,g as s,ab as xt,d as Y}from"../chunks/DiOX1np-.js";import{s as l}from"../chunks/9GPvL92g.js";import{s as St,a as Vt,i as D}from"../chunks/Cyrhthi-.js";import{e as gt,i as mt}from"../chunks/CMkO9gSr.js";import{u as Zt}from"../chunks/CWvmpTdw.js";const tt=0,P=1,at=2;function Kt(d,o,p,j,k){M&&Ft();var g=d,m=qt(),I=Jt,f=dt,r,a,c,b=(m?vt:ft)(void 0),h=(m?vt:ft)(void 0),T=!1;function v(n,u){T=!0,u&&(ut(y),_t(y),pt(I));try{n===tt&&p&&(r?W(r):r=J(()=>p(g))),n===P&&j&&(a?W(a):a=J(()=>j(g,b))),n===at&&k&&(c?W(c):c=J(()=>k(g,h))),n!==tt&&r&&X(r,()=>r=null),n!==P&&a&&X(a,()=>a=null),n!==at&&c&&X(c,()=>c=null)}finally{u&&(pt(null),_t(null),ut(null),Ot())}}var y=zt(()=>{if(f!==(f=o())){if(Ht(f)){var n=f;T=!1,n.then(u=>{n===f&&(Q(b,u),v(P,!0))},u=>{if(n===f&&(Q(h,u),v(at,!0),!k))throw h.v}),M?p&&(r=J(()=>p(g))):Gt(()=>{T||v(tt,!0)})}else Q(b,f),v(P,!1);return()=>f=dt}});M&&(g=Bt)}function bt(d,o,p){if(p){if(d.classList.contains(o))return;d.classList.add(o)}else{if(!d.classList.contains(o))return;d.classList.remove(o)}}async function Mt(d){try{if(!d)return null;const o=await fetch("http://localhost:8000/api/dashboard-data/",{method:"GET",headers:{Authorization:`Token ${d.token}`,"Content-Type":"application/json"}});if(!o.ok){const k=(await o.json()).error||"Failed to fetch dashboard data";return console.log(k),null}return await o.json()}catch(o){return console.error("Error during login:",o),null}}var Qt=x('<div class="flex justify-between items-center"><span class="capitalize"> </span> <div class="text-right"><div class="font-semibold"> </div> <div class="text-sm text-gray-500"> </div></div></div>'),Wt=x('<div class="flex justify-between items-center"><span class="w-2/3 text-nowrap overflow-x-hidden text-ellipsis"> </span> <div class="text-right"><div class="font-semibold"> </div> <div class="text-sm text-gray-500"> </div></div></div>'),Xt=x('<div class="bg-[--surface] p-4 rounded-lg shadow"><h3 class="text-lg font-semibold mb-4">Top Vendors</h3> <div class="space-y-3"></div></div>'),Yt=x('<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"><div class="bg-[--surface] p-4 rounded-lg shadow"><h3 class="text-lg font-semibold mb-4">Expense Categories</h3> <div class="space-y-3"></div></div> <!></div>'),Dt=x('<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"><div class="bg-[--surface] p-4 rounded-lg shadow"><h3 class="text-lg font-semibold text-gray-200">Income</h3> <p class="text-2xl font-bold text-green-600"> </p> <p class="text-sm text-gray-500"> </p></div> <div class="bg-[--surface] p-4 rounded-lg shadow"><h3 class="text-lg font-semibold text-gray-200">Expenses</h3> <p class="text-2xl font-bold text-red-600"> </p> <p class="text-sm text-gray-500"> </p></div> <div class="bg-[--surface] p-4 rounded-lg shadow"><h3 class="text-lg font-semibold text-gray-200">Net Balance</h3> <p class="text-2xl font-bold"> </p> <p class="text-sm text-gray-500"> </p></div></div> <!> <div class="mt-8 p-4 bg-[--surface] rounded"><h3 class="text-sm font-mono">Debug Data:</h3> <pre class="text-xs overflow-auto"> </pre></div>',1),ta=x('<div class="bg-[--surface] border border-yellow-200 text-yellow-600 p-4 rounded-lg"><p>No dashboard data available</p></div>'),aa=x('<div class="bg-[--surface] border border-red-200 text-red-700 p-4 rounded-lg"><p> </p></div>'),ea=x('<div class="flex items-center justify-center h-64"><p class="text-gray-500">Loading dashboard data...</p></div>'),sa=x('<div class="p-4 container mx-auto"><h1 class="text-3xl font-bold mb-6">Financial Dashboard</h1> <!></div>');function va(d,o){Pt(o,!1);const[p,j]=Vt(),g=Mt(St(Zt,"$user",p)),m=(r,a="UAH")=>r==null?"-":new Intl.NumberFormat("uk-UA",{style:"currency",currency:a}).format(r);g.then(r=>{console.log("Dashboard data received:",r)}).catch(r=>{console.error("Dashboard data error:",r)}),Ct();var I=sa(),f=i(e(I),2);Kt(f,()=>g,r=>{var a=ea();_(r,a)},(r,a)=>{var c=At(),b=xt(c);{var h=v=>{var y=Dt(),n=xt(y),u=e(n),R=i(e(u),2),ht=e(R,!0);t(R);var et=i(R,2),yt=e(et);t(et),t(u);var S=i(u,2),V=i(e(S),2),wt=e(V,!0);t(V);var st=i(V,2),$t=e(st);t(st),t(S);var rt=i(S,2),L=i(e(rt),2),kt=e(L,!0);t(L);var it=i(L,2),Nt=e(it);t(it),t(rt),t(n);var ot=i(n,2);{var Et=U=>{var A=Yt(),C=e(A),B=i(e(C),2);gt(B,5,()=>s(a).data.expense_categories,mt,(q,w)=>{var N=Qt(),z=e(N),F=e(z,!0);t(z);var E=i(z,2),$=e(E),Z=e($,!0);t($);var H=i($,2),G=e(H);t(H),t(E),t(N),O(K=>{l(F,s(w).category||"Uncategorized"),l(Z,K),l(G,`${s(w).count??""} transactions`)},[()=>m(s(w).total)],Y),_(q,N)}),t(B),t(C);var It=i(C,2);{var Tt=q=>{var w=Xt(),N=i(e(w),2);gt(N,5,()=>s(a).data.top_vendors,mt,(z,F)=>{var E=Wt(),$=e(E),Z=e($,!0);t($);var H=i($,2),G=e(H),K=e(G,!0);t(G);var ct=i(G,2),Lt=e(ct);t(ct),t(H),t(E),O(Ut=>{l(Z,s(F).vendor||"Unknown"),l(K,Ut),l(Lt,`${s(F).transaction_count??""} transactions`)},[()=>m(s(F).total_spent)],Y),_(z,E)}),t(N),t(w),_(q,w)};D(It,q=>{s(a).data.top_vendors&&q(Tt)})}t(A),_(U,A)};D(ot,U=>{s(a).data.expense_categories&&U(Et)})}var nt=i(ot,2),lt=i(e(nt),2),jt=e(lt,!0);t(lt),t(nt),O((U,A,C,B)=>{l(ht,U),l(yt,`${s(a).data.basic_stats.income.count||0} transactions`),l(wt,A),l($t,`${s(a).data.basic_stats.expenses.count||0} transactions`),bt(L,"text-green-600",s(a).data.basic_stats.net>0),bt(L,"text-red-600",s(a).data.basic_stats.net<0),l(kt,C),l(Nt,`${s(a).data.basic_stats.total_transactions||0} total transactions`),l(jt,B)},[()=>m(s(a).data.basic_stats.income.total),()=>m(s(a).data.basic_stats.expenses.total),()=>m(s(a).data.basic_stats.net),()=>JSON.stringify(s(a),null,2)],Y),_(v,y)},T=v=>{var y=ta();_(v,y)};D(b,v=>{s(a)&&s(a).data&&s(a).data.basic_stats?v(h):v(T,!1)})}_(r,c)},(r,a)=>{var c=aa(),b=e(c),h=e(b);t(b),t(c),O(()=>l(h,`Error loading dashboard: ${s(a)??""}`)),_(r,c)}),t(I),_(d,I),Rt(),j()}export{va as component};
